<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Untitled Document</title>
</head>

<body>
<p align="center"><strong>&nbsp;</strong></p>
<p align="center"><strong>HIMSS and RSNA</strong><br />
    <strong>Integrating the Healthcare Enterprise</strong></p>
<p align="center"><strong>&nbsp;</strong></p>
<p align="center"><strong>&nbsp;</strong><strong>IHE/MESA External Report Repository Tests</strong></p>
<p>&nbsp;</p>
<p align="center">Electronic Radiology  Laboratory<br />
  Mallinckrodt Institute of  Radiology<br />
  510 South    Kingshighway Blvd. <br />
  St. Louis, MO&nbsp; 63110 <br />
  314.362.6965 (Voice)<br />
  314.362.6971 (Fax)</p>
<p align="center">&nbsp;</p>
<p align="center">Revision 9.0.0<br />
  20-September-2005 </p>
<strong>Contents:</strong><br clear="all" />
<p><a href="#ext_rep_tests">External Report  Repository Tests</a><br />
  <a href="#intro">Introduction</a><br />
  <a href="#msg_att">Message Attributes</a><br />
  <a href="#msg_values">Message Values</a><br />
  <a href="#config">Configuration</a><br />
  <a href="#start_servers">Starting  the MESA Servers</a><br />
  <a href="#sub_results">Submission  of Results</a><br />
  <a href="#indiv_tests">Individual Tests</a></p>
<ol>
  <li><a href="#test_1001">External  Report Repository Test 1001: Modalities In Study</a><br />
  </li>
  <li><a href="#test_1002">External  Report Repository Test 1002: Related Series/SOP Instances</a><br />
  </li>
  <li><a href="#test_1003">External  Report Repository Test 1003: Other Report Repository Attributes</a><br />
  </li>
  <li><a href="#test_1004">External  Report Repository Test 1004: Report Specific Queries</a><br />
  </li>
  <li><a href="#test_1011">External  Report Repository Test 1011: SR Retrieve</a><br />
    <br clear="all" />
  &nbsp;</li>
</ol>
<h1><a name="#ext_rep_tests" id="#ext_rep_tests">External Report Repository Tests</a></h1>
<h2><a name="#intro" id="#intro">Introduction</a></h2>
<p>External Report Repositories are tested in two areas.&nbsp; The MESA  software will test C-Find responses and will test the structure of SR objects  stored in the repository.</p>
<h3>Integration Profiles and Test Procedures</h3>
<p>This document lists a number of tests for External Report  Repository Systems. You may not be responsible for all of these tests.<br />
  Please refer to the Connectathon web tool to list the  required tests for your system. The web address of this tool depends on the  year and project manager. Please contact the appropriate project manager to  obtain this information.</p>
<h2><a name="#msg_att" id="#msg_att">Message Attributes</a></h2>
<p>These tests will query the External Report Repository for  attributes using the DICOM C-Find command.&nbsp;  The table below lists the attributes used in the queries.</p>
<table border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td width="306" valign="top"><p><strong>Attribute Name</strong></p></td>
    <td width="156" valign="top"><p align="center"><strong>Tag</strong></p></td>
  </tr>
  <tr>
    <td width="462" colspan="2" valign="top"><p><strong>Study Level</strong><strong> </strong></p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>Study Date</p></td>
    <td width="156" valign="top"><p align="center">0008 0020</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>Study Time</p></td>
    <td width="156" valign="top"><p align="center">0008    0030</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>Accession Number</p></td>
    <td width="156" valign="top"><p align="center">0008    0050</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>Patient Name</p></td>
    <td width="156" valign="top"><p align="center">0010    0010</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>Patient ID</p></td>
    <td width="156" valign="top"><p align="center">0010    0020</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>Study ID</p></td>
    <td width="156" valign="top"><p align="center">0020    0010</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>Study Instance UID</p></td>
    <td width="156" valign="top"><p align="center">0020    000D</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>Modalities in Study</p></td>
    <td width="156" valign="top"><p align="center">0008    0061</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>Referring Physician&rsquo;s Name</p></td>
    <td width="156" valign="top"><p align="center">0008    0090</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>Patient&rsquo;s Birth Date</p></td>
    <td width="156" valign="top"><p align="center">0010    0030</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>Patient&rsquo;s Sex</p></td>
    <td width="156" valign="top"><p align="center">0010    0040</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>Number of Study Related    Series</p></td>
    <td width="156" valign="top"><p align="center">0020    1206</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>Number of Study Related    Instances</p></td>
    <td width="156" valign="top"><p align="center">0020    1208</p></td>
  </tr>
  <tr>
    <td width="462" colspan="2" valign="top"><p align="center"><strong>Series    Level</strong><strong> </strong></p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>Modality</p></td>
    <td width="156" valign="top"><p align="center">0008    0060</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>Series Number</p></td>
    <td width="156" valign="top"><p align="center">0020    0011</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>Series Instance UID</p></td>
    <td width="156" valign="top"><p align="center">0020    000D</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>Number of Series Related    Instances</p></td>
    <td width="156" valign="top"><p align="center">0020    1209</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>Request Attribute Sequence</p></td>
    <td width="156" valign="top"><p align="center">0040    0275</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>&gt;Requested Procedure ID</p></td>
    <td width="156" valign="top"><p align="center">0040    1001</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>&gt;Scheduled Procedure    Step ID</p></td>
    <td width="156" valign="top"><p align="center">0040    0009</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>Performed Procedure Step    Start Date</p></td>
    <td width="156" valign="top"><p align="center">0040    02444</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>Performed Procedure Step    Start Time</p></td>
    <td width="156" valign="top"><p align="center">0040    0245</p></td>
  </tr>
  <tr>
    <td width="462" colspan="2" valign="top"><p align="center"><strong>Composite    Object Instance Level</strong><strong> </strong></p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>Image Number</p></td>
    <td width="156" valign="top"><p align="center">0020    0013</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>SOP Instance UID</p></td>
    <td width="156" valign="top"><p align="center">0008    0018</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>SOP Class UID</p></td>
    <td width="156" valign="top"><p align="center">0008    0016</p></td>
  </tr>
  <tr>
    <td width="462" colspan="2" valign="top"><p align="center"><strong>SR    Specific Attributes</strong><strong> </strong></p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>Completion Flag</p></td>
    <td width="156" valign="top"><p align="center">0040    A491</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>Verification Flag</p></td>
    <td width="156" valign="top"><p align="center">0040    A493</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>Content Date</p></td>
    <td width="156" valign="top"><p align="center">0008    0023</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>Content Time</p></td>
    <td width="156" valign="top"><p align="center">0008    0033</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>Obsservation Date Time</p></td>
    <td width="156" valign="top"><p align="center">0040    A032</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>Verifying Observer Sequence</p></td>
    <td width="156" valign="top"><p align="center">0040    A073</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>&gt; Verifying Organization</p></td>
    <td width="156" valign="top"><p align="center">0040    A027</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>&gt; Verification Date Time</p></td>
    <td width="156" valign="top"><p align="center">0040    A030</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>&gt; Verifying Observer    Name</p></td>
    <td width="156" valign="top"><p align="center">0040    A075</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>&gt; Verifying Observer    Identification Code Sequence</p></td>
    <td width="156" valign="top"><p align="center">0040    A088</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>Referenced Request Sequence</p></td>
    <td width="156" valign="top"><p align="center">0040    A370</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>&gt; Study Instance UID</p></td>
    <td width="156" valign="top"><p align="center">0020    000D</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>&gt; Accession Number</p></td>
    <td width="156" valign="top"><p align="center">0008    0050</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>&gt; Requested Procedure ID</p></td>
    <td width="156" valign="top"><p align="center">0040    1000</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>&gt; Rrequested Procedure    Code Sequence</p></td>
    <td width="156" valign="top"><p align="center">0032    1064</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>&gt;&gt; Code Value</p></td>
    <td width="156" valign="top"><p align="center">0008    0100</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>&gt;&gt; Coding Scheme    Designator</p></td>
    <td width="156" valign="top"><p align="center">0008    0102</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>&gt;&gt; Code Meaning</p></td>
    <td width="156" valign="top"><p align="center">0008    0104</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>Concept Name Code Sequence</p></td>
    <td width="156" valign="top"><p align="center">0040    A043</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>&gt; Code Value</p></td>
    <td width="156" valign="top"><p align="center">0008    0100</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>&gt; Coding Scheme    Designator</p></td>
    <td width="156" valign="top"><p align="center">0008    0102</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>&gt; Coding Scheme Version</p></td>
    <td width="156" valign="top"><p align="center">0008    0103</p></td>
  </tr>
  <tr>
    <td width="306" valign="top"><p>&gt; Code Meaning</p></td>
    <td width="156" valign="top"><p align="center">0008    0104</p></td>
  </tr>
</table>
<h2><a name="#msg_values" id="#msg_values">Message Values</a></h2>
<h2><a name="#config" id="#config">Configuration</a></h2>
<p>The External Report Repository scripts described below use  an ASCII configuration file to identify parameters such as host names and port  numbers.&nbsp; The configuration file is named <em>ext_repos_test.cfg</em> and is included in  the directory <em>$MESA_TARGET/mesa_tests/rad/actors/ext_rpt_repos</em>.&nbsp; Edit the file and change entries (host name,  port number) which pertain to your system.&nbsp;  Your system is identified by entries that begin with TEST.<br />
  The file <em>$MESA_TARGET/runtime/wkstation/ds_dcm.cfg</em> is used to configure the MESA Report Reader.&nbsp;  The only parameter users should change is the LOG_LEVEL value.&nbsp; Log levels are defined in section 1.5.&nbsp; DICOM configuration parameters are listed in  the table below.</p>
<table border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td width="192" valign="top"><p align="center">Application</p></td>
    <td width="190" valign="top"><p align="center">AE Title</p></td>
    <td width="122" valign="top"><p align="center">Port</p></td>
  </tr>
  <tr>
    <td width="192" valign="top"><p>MESA    Report Reader</p></td>
    <td width="190" valign="top"><p align="center">WORKSTATION1</p></td>
    <td width="122" valign="top"><p align="center">3001</p></td>
  </tr>
</table>
<p>Read the <em>Runtime  Notes</em> section of the<em> Installation  Guide</em> to determine the proper settings for the MESA runtime environment.</p>
<h2><a name="#start_servers" id="#start_servers">Starting the </a>MESA Servers</h2>
<p>These instructions assume you are using a terminal  emulator on Unix systems or an MS DOS command window under Windows NT.&nbsp; Each test uses a command line interface;  there is no graphical user interface. Before you start the test procedure, you  need to start the MESA Report Reader.&nbsp;  Make sure the appropriate database is running (PostgreSQL, SQL  Server).&nbsp; To start the MESA servers:</p>
<ol start="1" type="1">
  <li>Enter       the External Report Repository exam folder: <em>mesa_tests/rad/actors/ext_rpt_repos</em></li>
  <li>Execute       the appropriate script to start the servers:</li>
</ol>
<pre>     scripts/start_mesa_servers.csh &nbsp;(Unix)</pre>
 <pre>     scripts\start_mesa_servers.bat  (Windows)</pre>
  When you are finished running one or more tests, you can  stop the servers:
  <pre>     scripts/stop_mesa_servers.csh  (Unix)</pre>
  <pre>     scripts\stop_mesa_servers.bat  (Windows)</pre>
  Log files are stored in <em>$MESA_TARGET/logs</em>.</p>
<h2><a name="#sub_results" id="#sub_results">Submission of Results</a></h2>
<p>Test descriptions below inform the reader to &ldquo;submit  results to the Project Manager&rdquo;. This is does not mean &ldquo;email&rdquo;. The current  submission process should be documented by the Project Manager, but will not  include emailing files directly to the Project Manager.</p>
<h1><a name="#indiv_tests" id="#indiv_tests">Individual Tests</a></h1>
<table><tr><td bgcolor="#33FFFF">
<h2><a name="#test_1001" id="#test_1001">External Report Repository Test 1001: Modalities  In Study</a></h2>
<p>The DICOM attribute 0008 0061 is named &ldquo;Modalities in  Study&rdquo;.&nbsp; The 801 series tests will send  four Study Level queries to the Report Repository and query on this  attribute.&nbsp; The table below lists the  four queries (a-d) and the values used for matching key.&nbsp; For the a query, the attribute 0008 0061 is  sent as zero length, so this becomes a return key.</p>
<table border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td width="126" valign="top"><p align="center"><strong>Query</strong></p></td>
    <td width="204" valign="top"><p align="center"><strong>Value for Attribute 0008 0061</strong></p></td>
  </tr>
  <tr>
    <td width="126" valign="top"><p align="center">a</p></td>
    <td width="204" valign="top"><p align="center">&ldquo;&rdquo;</p></td>
  </tr>
  <tr>
    <td width="126" valign="top"><p align="center">b</p></td>
    <td width="204" valign="top"><p align="center">&ldquo;SR&rdquo;</p></td>
  </tr>
  <tr>
    <td width="126" valign="top"><p align="center">c</p></td>
    <td width="204" valign="top"><p align="center">&ldquo;CT&rdquo;</p></td>
  </tr>
</table>
<h3>References</h3>
<h3>Instructions</h3>
<ol>
  <li>Start the MESA  servers as decribed in <a href="#start_servers">Starting the MESA Servers</a>.</li>
  <li>Clear your repository of any objects that are not SR  objects.&nbsp; Place other objects that should  be tested in your repository.</li>
  <li>Run the script which sends three queries to your  External Report Repository. The one argument to the script is the Patient ID of  a patient you select with appropriate test data.</li>
  <pre>perl 1001/1001_rptrepos.pl &lt;patient  ID&gt;</pre>
  </ol>
<h3>Evaluation</h3>
<ol>
  <li>Evaluate the response of your system to queries a, b,  and c:</li>
  <pre>perl 1001/eval_1001.pl</pre>
  </ol><h3>Supplemental Information</h3></td>
</tr></table>
<h2><a name="#test_1002" id="#test_1002">External Report Repository Test 1002: Related  Series/SOP Instances</a></h2>
<p>These tests query Report Repositories for DICOM attributes  Number of Study Related Series, Number of Study Related SOP Instances.</p>
<h3>References</h3>
<h3>Instructions</h3>
<ol>
  <li>Start the MESA  servers as decribed in <a href="#start_servers">Starting the MESA Servers</a>.</li>
  <li>You may use the same SR objects as with test 1001 (or  load your repository with different objects).</li>
  <li>Run the script which sends one query to your External  Report Repository. The one argument to the script is the Patient ID of a  patient you select with appropriate test data.</li>
  <pre>perl  1002/1002_rptrepos.pl &lt;patient ID&gt;</pre>
</ol>
<h3>Evaluation</h3>
<ol>
  <li>Evaluate the response of your system:</li>
  <pre>perl 1002/eval_1002.pl</pre>
</ol> <h3>Supplemental Information</h3>
<table><tr><td bgcolor="#33FFFF">
<h2><a name="#test_1003" id="#test_1003">External Report Repository Test 1003: Other  Report Repository Attributes</a></h2>
</td></tr></table>
<h2><a name="#test_1004" id="#test_1004">External Report Repository Test 1004: Report  Specific Queries</a></h2>
<table><tr><td bgcolor="#33FFFF">
<h2><a name="#test_1011" id="#test_1011">External Report Repository Test 1011: SR  Retrieve</a></h2>
<p>This test will retrieve SR objects according to a Patient  ID specified by you.&nbsp; Each object will be  evaluated for &ldquo;compliance with TID 2000&rdquo;.&nbsp;  The phrase &ldquo;compliance with TID 2000&rdquo; is stated in quotes because the  tests are simplistic and are not meant to imply that your SR object is totally  compliant the DICOM Supplement 53 and TID 2000.</p>
<h3>References</h3>
<h3>Instructions</h3>
<ol>
  <li>Start  the MESA  servers as described in <a href="#start_servers">Starting the MESA Servers</a>.</li>
  <li>You  may use the same SR objects as with test 1001/1002 (or load your repository  with different objects).</li>
  <li>Run  the script which sends C-Find and C-Move commands to your External Report  Repository.&nbsp; The one argument to the  script is the Patient ID of a patient you select with appropriate test data.</li>
  <pre>perl 1011/1011_rptrepos.pl &lt;patient ID&gt;</pre>
  </ol>
<h3>Evaluation</h3>
<ol>
  <li>Evaluate  the response of your system</li>
</ol><pre>     perl  1011/eval_1011.pl &lt;patient ID&gt;</pre>
 <h3>Supplemental Information</h3>
</td>
</tr></table>
</body>
</html>
